name: Main workflow 

on:
 push:
    # Sequence of patterns matched against refs/heads
    branches:
      - master         # Push events on master branch
      - 'releases/*'   # Push events to branches matching refs/heads/releases/*

jobs:
  make_test:
    name: make_test
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: cocoapods
      run: sudo gem install cocoapods 
    - name: make_test
      run: make test

  run_perf_ci:
    name: run_perf_ci
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: cocoapods
      run: sudo gem install cocoapods 
    - name: run_perf_ci
      run: make run_perf_ci

  run_swift:
    name: run_swift
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: run_swift
      run: make run_swift

  run_force_bazel:
    name: run_force_bazel
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: run_force_bazel
      run: make run_force_bazel

  goldmaster:
    name: goldmaster
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: goldmaster
      run: make goldmaster

  workspace:
    name: workspace
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: workspace
      run: make workspace

  workspace_v2:
    name: workspace_v2
    runs-on: macOS-latest
    steps:
    - name: checkout_repo
      uses: actions/checkout@v1
    - name: workspace_v2
      run: make workspace_v2

